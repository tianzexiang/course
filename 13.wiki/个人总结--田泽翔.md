# ✍ 个人总结 -- 田泽翔

## 📱 大项目总结

### 项目总体感受

**先说结论：** 本次完成初版代号`Feed App`的信息流大项目，是真真正正的学到了很多，当然也难以避免地发现了自己的不足之处，实感性地理解到了自己在前端学习道路上的任重而道远。需要加强react某些点的深入学习，需要更多了解单元测试，需要进一步学习如何自己配置开发框架添加额外需求，目前一整套流程走下来，还差最后一个环节，打包部署没有实际学习过，之后结束后，可能自己会去了解这方面的东西，尝试将这个项目部署上线，甚至之后我还想用react native重新写一遍，后端也把轮询改成websocket的方式，当然这么做一方面是可以利用这个项目的成果去继续深入学习，一方面是有打磨该项目用于毕设的心思。

**个人认为自己水准以上的表现：** 

1. 项目框架搭建：
   * 前后端两套eslint规则，利用husky在commit时规范代码，给出代码规范错误提示信息。
   * 按照需求规范了文件目录，统一了文件归属，统一了文件命名规范，统一了路由定义规范，提前定义好全局Scss变量，如导航栏高度、主题色、文字大小等。提前封装好组员可能常用的组件`CustomList、CustomSwiperTab、CustomDotLoading`等。
   * 利用`axios`封装http请求，并且封装好各种参数处理方法，并在拦截器中实现后端返回错误的统一提示处理。
   * 后端统一了参数校验方法，统一错误定义方法、抛出方法，使得组员代码风格能够尽可能统一。
2. 快速的学习了微信第三方登录，并按照老师提醒的安全问题将信息存储于后端，快速搭建起整个项目登录、注册、切换前端路由、鉴权的流程，使得组员能够尽快的上手测试后续开发。
3. 学习并在项目中使用了前端图片裁剪以及压缩。
4. 引入了浏览器`IntersectionObserver`Api，解决了自己以及组员各种功能实现上的问题，替换之前监听scroll事件的方法，些微提升了项目性能。
5. 封装好中英文字符长度判断方法以供组员调用。
6. 关注页面的同步处理。
7. 自身任务完成后，立即协助组员完成较难完成的功能，如一些样式bug、聊天页面下拉加载更多等，并完善了项目的一些细节、提升使用体验，比如网速较慢情况下的骨架屏动画、button loading动画、页面切换时数据加载动画。

**个人认为自己水准以下的表现：** 
1. 不熟悉MongoDB的原因，后端service处的查询语句写的实属不够优雅，聚合查询用的很随意，没有考虑所谓的连表性能，重复代码也稍多，有些查询结果的字段替换甚至直接用js做的处理。
2. 个人首页部分无法做到像B站这种软件一样丝滑的动画。因为三个tab标签页需要三个独立滚动容器的原因，外部父容器滚动结束后无法立即滚动子元素的滚动容器，需要松手后才能接着滚动，时间原因暂时没有想到好的解决办法。
3. 聊天页面进入需要首先触底的功能因为图片加载完成速度不一的问题，导致无法精准测量到scrollHeight，所以会有先触底后图片加载完成后撑开一些高度的现象。目前采取的是死办法，即固定图片高度，使得没有加载显示完图片，高度也能计算。
4. 不熟悉React渲染流程，比如这次聊天页面的功能，需要等待数据拉取完成，根据数据渲染的高度来将滚动条置底部的时机，我是利用数据loading结束来判断，虽然就结果论而言是没有错误的，但实际上数据拉取结束后，已经能获取数据渲染的高度这件事的整个内部流程的实际过程我是不清楚的，所以项目结束后我得好好学习补足这方面的知识。
5. 没有考虑到一些css属性不兼容手机浏览器的情况，目前已经全部替换。

### 项目细节

#### 主要完成工作
* 商讨数据结构
* 前后端项目搭建，前端常用组件封装、请求工具封装， 后端项目日志中间件、鉴权中间件、规范代码风格
* 微信登陆注册
* 用户前后端
* 关注前后端
* 搜索后端
* 裁剪图片
* 私信页面下拉加载更多
* 自己的接口测试

#### 遇到的问题以及解决办法
1. 聊天页面布局问题，去看了下infiniteScroll源码，感觉思路相似，但是很明显那边处理的情况更多更详细，想要依次复现改动有些困难，所以另求办法。下拉加载更多最先思路是判断scrollTop，监听scroll滚动。但这样有两个问题，一是scrollTop抖动，二是监听scroll滚动性能很差。仔细思索下，想起之前看阮一峰大佬用过一个web api`intersectionObserver`正好可以用来处理当前情况，具体文章信息可以参考[intersectionObserver](https://ruanyifeng.com/blog/2016/11/intersectionobserver_api.html)，其实在react Hook FAQ中也有提到[我该如何测量 DOM 节点？](https://react.docschina.org/docs/hooks-faq.html#how-can-i-measure-a-dom-node)，里面大概讲了`callback ref`，以及`ResizeObserver`。这里问题解决方法基本是找到了，但在react中使用仍有问题。react中的state无法在observer中更新，所以可能需要进一步封装该api使得能够在react中使用。鉴于时间原因，我想是不是会有相关库，于是去npm上利用关键词搜索了一下，果然发现相关库`react-intersection-observer`，在react中尝试使用后，比较完美的实现了下拉加载更多的功能。
2. 图片尺寸不合问题，使用图片裁剪完成，顺便完成前端简单的图片压缩。封装基本图片裁剪组件CropImage，主要是操作canvas将图片data放上去，利用获取到的图像坐标裁剪即可，按照比例裁剪图片同时可以放大缩小图片，利用`toDataURL、toBlob`方法将canvas转换成压缩过后的图片数据。
3. 一开始将获取微信用户信息的接口放到前端去请求，在地址为localhost下没有出现跨域问题。但换成手机以局域网地址登录项目后，出现跨域问题，于是将请求放置后端解决。出现该情况原因是：
   ```
   localhost：本地服务器，不经过网卡传输的，它不受网络防火墙和网卡相关的限制。
   127.0.0.1或局域网地址：域名访问，通过网卡传输的，依赖网卡，并受到网络防火墙和网卡相关的限制。
   ```
4. 获取登录关注列表的同时获取是否相互关注，获取别人关注列表的同时也是或取列表用户与登录用户的关系。解决方案是，分页查询同时通过连自身表查询，传入一个relationId（需要查找关系的用户，一般就是登录用户）。
5. 一些css属性在手机浏览器端不兼容，这个只能找出来修改，但还好用的不多，目前暂无不兼容情况。
6. 个人首页父子滚动容器衔接不够顺滑问题
7. 当网速过慢时导致白屏体验很差，关注按钮点击甚至没有反应，通过封装统一的loading动画以及开启button loading解决。
8. 当脱机时，因为轮询和统一错误处理的原因，导致不停出现错误提示，通过使用throttle控制了toast出现间隔，提醒用户同时不至于过于频繁出现。

### 个人收获

首先，我想最大的收获应该是实际体验并明白了在勉强接近真实开发过程中的团队协作、团队规范、处理问题的重要性。因为有过前一次Form App的菜鸟合作开发经历，这一次我和小组成员好好协商了项目规范，每个人都能尽可能遵从制定好的规范来写代码，所以不管是接手组员代码修改bug还是合并组员代码，或是使用组员封装好的组件等，过程都还算顺利，即使有些不明白的位置也都是组员做了一些特殊的逻辑处理，稍微问一问便能明白，很好提高了开发效率。

其次，补足了很多前端知识：对接第三方，图片处理、裁剪，跨域处理，react一些api的深入理解等。

再然后，是明白了光将项目功能完成是不够的，还得考虑一些极端情况，样式会不会不兼容，用户疯狂点击怎么办，图片过大、过长怎么办，用户输入过长、空格很多怎么办，网速过慢导致加载白屏时间长甚至按钮无反应怎么办，脱机了又怎么办等，这些地方的完善也都是相当耗人精力的，不容易被发现的。

最后是不管是前端还是后端项目，完成后的测试都非常重要，比如这次通过前端测试发现极端问题，通过后端测试发现一个接口返回数据差了一个字段，我们这次还是做的简单测试，由此可见测试的重要性。

## 📖 暑期实习总结

### 暑期实习总体感受

**还是一样先说结论：** 收获相当多，因为课程涉及面广加之以前主要使用Vue，所以虽然只有短短两个月不到的时间，但本次在前端道路上的学习不夸张地说是迈了不小的一步。回忆一下大致内容，`react hooks, node, koa, ssr`，加之最后大项目补充的知识点，可以说整套开发流程除了打包配置部署还未涉及到，开发中该有的内容基本都通过项目的形式学习并加深了印象。当然，这并不代表我已经完完全全对前端那一套都熟悉了，反而可以说学的越多自己对于前端领域的无知显得反而越发明显，加之而来的还有无知带来的压力感以及想要弄清楚原理的好奇心。但有些可惜的是，本次课程安排项目时间很紧，大多情况真的就是边学边做，赶鸭子上阵，有些内容真的不是花两三个小时看看文档就能完全弄明白的，所以实话实说，虽然做完了项目，但我也只敢保证我项目中使用的东西100%下次我能使用，80%我能讲一些原理出来，剩下的20%是能用，但我讲不出个所以然来，至于没用到的，那就真的是两眼一抹黑了，仅仅就是粗略过了一遍的程度。

**个人认为自己水准以上的表现：** 

1. 所有任务都是秉持着做到最好的心态来完成的，不会因为时间紧迫而随意写代码，尽可能会按照老师要求的规范要求自己。
2. 早上坐车会计划好今天大概想要完成的任务和目标，类似上午完成什么，下午完成什么（但是一般碰到难解决的问题，计划就没了😢）。
3. 每次作业都会有改进、复盘，比如第一次作业助教说封装组件零碎、context内容过多，我第三次便尽可能改善了第一次的错误，第四次作业又在第三次作业基础上，进一步完善了组件封装。
4. 遇到不懂不会的问题会想办法解决，问组员也好，助教也好，老师也好，我碰到的问题会想办法解决，比如MongoDB的递归查询，useState、useEffect的深入理解，nextjs动态路由不会刷新数据问题，正则统计代码的写法，nexjs的请求代理，洋葱模型的深入理解，enum导出的ts编译错误，正则组匹配的卡死等，详细内容在个人每日总结中。
5. 有通读官方文档的习惯（虽然容易忘），来回坐车的路上一般都会去官网学习本周要用的知识

**个人认为自己水准以下的表现：**

1. 完成项目时间较长，没有时间研究一些原理问题，项目做完了也只是达到基本能使用以及理解部分原理的标准，比如node的学习，我感觉这一块是我本次暑期学习最薄弱的板块，文件系统的接口都能使用，但那些node事件循环模型也只是粗略看了一下，没有深入学习了解。
2. 前几次个人作业不像最后一次大项目一样考虑细致，没有考虑到样式不兼容，极端网速、脱机的情况。没有做一些动画完善用户体验，仅仅是完成了老师要求的功能。
3. 与大作业一样，后端的查询数据库操作，写的很随意。
4. nextjs首屏渲染快、对SEO友好的原理因为有老师的图片文字讲解理解的比较清晰了，但是不依靠框架自己实现hydration目前有困难，这是亟待后续补上的知识内容。

### 个人收获

首先，最重要的收获是对前后端整体流程有了清晰的认知，ssr这种以前只听过没用过的知识目前也算是初入门径，学习了ssr、ssg、csr等不同渲染方式的区别。后端接口测试也算是开了一个小头，目前仍差的便是项目打包配置部署了。

其次，是对react hook的理解是随着项目写的越多有了更加深入的理解，如何抽离逻辑，如何配合请求进行封装，对于状态的理解，如何获取动态元素信息，官方hook理解上的坑，合理使用context等

再然后是后端node、koa的学习，不仅仅是有了基础的编写CRUD项目的能力、学习到了如何写日志处理、服务错误处理、中间件鉴权等，还学会了如何规划node后端项目，如何配置env环境，以及session、cookie那一套的整体流程如何运行，前端如何判断是否登录，后端如何通过salt加密存储。

最后便是大项目学习到的项目规划，团队合作，数据结构设计，任务管理，第三方对接，极端情况处理，用户体验等。





